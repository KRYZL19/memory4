"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const debug_1 = __importDefault(require("debug"));
const config_1 = __importDefault(require("../config"));
const platforms_1 = __importDefault(require("./platforms"));
const log = (0, debug_1.default)('sockethub:bootstrap:init');
log('running init routines');
const packageJSON = require('./../../package.json');
const platforms = (0, platforms_1.default)(Object.keys(packageJSON.dependencies));
log('loaded platforms');
if (config_1.default.get('help')) {
    // eslint-disable-next-line security-node/detect-crlf
    console.log(packageJSON.name + ' ' + packageJSON.version);
    console.log('command line args: ');
    console.log();
    console.log('  --help     : this help screen');
    console.log('  --info     : displays some basic runtime info');
    console.log();
    console.log('  --examples : enables examples page and serves helper files like jquery');
    console.log();
    console.log('  --host     : hostname to bind to');
    console.log('  --port     : port to bind to');
    console.log();
    process.exit();
}
else if (config_1.default.get('info')) {
    // eslint-disable-next-line security-node/detect-crlf
    console.log(packageJSON.name + ' ' + packageJSON.version);
    console.log();
    // eslint-disable-next-line security-node/detect-crlf
    console.log('examples enabled: ' + config_1.default.get('examples:enabled'));
    // eslint-disable-next-line security-node/detect-crlf
    console.log('sockethub: ' + config_1.default.get('service:host') + ':' + config_1.default.get('service:port')
        + config_1.default.get('service:path'));
    if (config_1.default.get('redis:url')) {
        // eslint-disable-next-line security-node/detect-crlf
        console.log('redis URL: ' + config_1.default.get('redis:url'));
    }
    else {
        // eslint-disable-next-line security-node/detect-crlf
        console.log('redis: ' + config_1.default.get('redis:host') + ':' + config_1.default.get('redis:port'));
    }
    // eslint-disable-next-line security-node/detect-crlf
    console.log('public url: ' + config_1.default.get('public:host') + ':' + config_1.default.get('public:port')
        + config_1.default.get('public:path'));
    console.log();
    // eslint-disable-next-line security-node/detect-crlf
    console.log('platforms: ' + Array.from(platforms.keys()).join(', '));
    if (platforms.size > 0) {
        for (let platform of platforms.values()) {
            console.log();
            // eslint-disable-next-line security-node/detect-crlf
            console.log('  ' + platform.id + ' v' + platform.version);
            // eslint-disable-next-line security-node/detect-crlf
            console.log('    AS @types: ' + platform['@types']);
        }
        console.log();
        process.exit();
    }
    else {
        console.log();
        process.exit();
    }
}
log('finished init routines');
const init = {
    version: packageJSON.version,
    platforms: platforms
};
exports.default = init;
//# sourceMappingURL=/bootstrap/init.js.map